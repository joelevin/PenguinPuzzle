package {	import flash.display.MovieClip;	import flash.events.Event;	import flash.display.Stage;	import Penguin;	import Orca;	import Cave;	import CustomClick;	import Game;	import flash.events.MouseEvent;	import flash.ui.Mouse;	public class Main extends MovieClip	{		public var stageRef:Stage;		public var theGame:Game;		private var replayButton:CustomClick;		public function Main()		{			// constructor code			init();		}		public function init():void		{			this.addEventListener(Event.ADDED_TO_STAGE,addedToStageHandler);		}		private function addedToStageHandler(e:Event = null):void		{			stageRef = stage;			replayButton = new CustomClick(50, 50, 1, 1, 0xFF0000,"REPLAY",10,0x000000);			initializeGame();		}		public function initializeGame():void		{			theGame = new Game(stageRef);			if (! stageRef.contains(theGame))			{				stageRef.addChild(theGame);			}			theGame.init();			/*while (theGame.pinguino.alive == false)			{				createReplayButton();			}*/			createReplayButton();					}				private function createReplayButton():void		{			stageRef.addChild(replayButton);			replayButton.x = stageRef.stageWidth - 100;			replayButton.y = stageRef.stageHeight - 75;						replayButton.addEventListener(MouseEvent.CLICK,replayHandler);		}				private function replayHandler(m:MouseEvent):void		{			replay();		}				private function replay():void		{						/*			stageRef.removeEventListener(MouseEvent.CLICK,mouseClickHandler);			stageRef.removeEventListener(MouseEvent.MOUSE_MOVE,mouseMovementHandler);			stageRef.removeEventListener(Event.ENTER_FRAME, movePenguin);			this.removeEventListener(Event.ADDED_TO_STAGE,addedToStageHandler);									pinguino = null;			orca = null;			cave = null;			caves = null;			bigArrow = null;			foreground = null;									var resetChildren:uint = stageRef.numChildren;			for (var i:int = 0; i < resetChildren; i++)			{				stageRef.removeChildAt(0);				trace("stageRef.numChildren " + stageRef.numChildren);				trace("resetChildren " + resetChildren);			}						//stageRef = null;			replayButton = null;			addedToStageHandler();					*/			//this.parent.initializeGame();			stageRef.removeChild(theGame);			theGame = null;						initializeGame();		}	}}